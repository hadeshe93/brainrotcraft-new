# 实现拉取机制

我想让你为我实现游戏数据远程拉取机制，请你先根据我如下的需求文档，进行分析、评估、审核，有问题可以向我提问，最后要求以 Markdwon 格式输出一份中的文需求实现指引文档，保存到 @docs/biz/project/dev-fetch/ 目录下，供我审核，我审核通过之后方可开始写代码。ultrathink

要求：
1. 文档信息浓缩但不遗漏任何重点或细节，避免重复描述；
2. 文档涉及到 UI 的部分需要用 ASCII 描绘示意稿；

## 需求文档

我需要为了将来的游戏子站点，实现一个游戏数据远程拉取机制。本项目作为母站点，所有游戏相关数据都会优先在这里录入，然后子站点继承本项目所有架构和代码，可以在其 CMS 中通过请求母站点接口的方式来拉取母站点数据。其中母站点在本地开发调试时为了验证拉取机制，可以向一个特殊接口来请求 Mock 数据。

以下列出具体需求点：
1. CMS 新增数据拉取页面；
2. 侧边栏和 CMS 首页都需要新增入口；

### CMS 新增数据拉取页面

页面 UI 需求设计：
- 包含 4 个卡片，内容为以下能力模块的入口；
- 点击具体卡片展示对应弹窗，弹窗中拉取母站点对应数据并以表格形式展示；

具体能力模块：
- 拉取远程母站点的所有分类数据
- 拉取远程母站点的所有标签数据
- 拉取远程母站点的所有特性合集数据
- 拉取远程母站点的所有游戏数据

要求：
- 拉取数据时，需要将除了自增 ID `id` 之外的数据拉取过来；
- 拉取分类、标签、特性合集数据时直接拉取原表数据即可，不需要拉取其下有关系的游戏数据；
- 拉取游戏数据时，需要拉取相关的分类、标签和特性合集数据，如果子站点本身的数据表中没有对应的数据，那么也要新增，判断依据为 `uuid` 字段；
- 不需要拉取多语言的翻译表数据；
- 分类、标签、特性合集设置一键拉取所有数据按钮以及单个拉取按钮，但是仅展示出来未存在子站点本身数据表中的数据，判断依据为 `uuid` 字段；
- 游戏仅设置单个拉取按钮，但是仅展示出来未存在子站点本身数据表中的数据，判断依据为 `uuid` 字段；
- 拉取、读取、写入等操作时，CMS 前端界面需要展示加载态，请使用简单的转圈 Loading 表示即可；

### CMS 新增接口

具体接口规划：
- 具体数据拉取接口：分类、标签、特性合集和游戏数据，由 CMS 前端触发
- 具体数据提供接口：对应于给拉取接口提供数据

---

请你严格按照 @docs/biz/project/dev-fetch/implementation-guide.md 文档开始实现功能。ultrathink

---

请你审查一下刚才写的代码是否符合 @docs/biz/project/dev-fetch/implementation-guide.md  文档所要求的功能。这时候先不要动代码，仅审核，然后汇总给我一个统计。ultrathink

---

@src/components/admin/fetch/fetch-games-dialog.tsx 中一共有两处拉取数据的地方，由于游戏的数据量大，需要异化拉取策略：
1. 拉取母站所有游戏的 `uuid`，为数组 A，其他字段不要；
2. 拉取子站所有游戏的 `uuid`，为数组 B，其他字段不要；
3. 找出不在 B 中的 `uuid`，作为 C，然后本地做分页，同时给弹窗内的表格做分页，去拉取母站对应的游戏信息；
4. 步骤 1 和 2 可以并发进行的。

---

@src/services/fetch/client.ts 中提供的 `getParentSiteConfig` 函数，我看到在导入阶段使用了，但是我理解在查询母站数据进行对比的时候也应该用上，请你看看。ultrathink

---

请你给作为母站点给子站点提供数据的几个接口加上跨域头吧，在 @src/constants/config.ts 维护一个子站点域名白名单列表。
